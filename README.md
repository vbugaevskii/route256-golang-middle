# Домашнее задание 1

- Создать скелеты трёх сервисов по описанию АПИ из файла contracts.md
- Структуру проекта сделать с учетом разбиения на слои, бизнес-логику писать отвязанной от реализаций клиентов и хендлеров
- Все хендлеры отвечают просто заглушками
- Сделать удобный враппер для сервера по тому принципу, по которому делали на воркшопе
- Придумать самостоятельно удобный враппер для клиента
- Все межсервисные вызовы выполняются. Если хендлер по описанию из contracts.md должен ходить в другой сервис, он должен у вас это успешно делать в коде.
- Общение сервисов по http-json-rpc
- должны успешно проходить make precommit и make run-all в корневой папке
- Наладить общение с product-service (в хендлере Checkout.listCart). Токен для общения с product-service получить, написав в личку @badger_za

*Дедлайн: 27 мая, 23:59 (сдача) / 30 мая, 23:59 (проверка)*

# Домашнее задание 2

Перевести всё взаимодействие c сервисами на протокол gRPC.

Для этого:

- Использовать разделение на слои, созданное ранее, заменив слой HTTP на GRPC.
- Взаимодействие по HTTP полностью удалить и оставить только gRPC.
- В каждом проекте нужно добавить в Makefile команды для генерации кода из proto файла и установки нужных зависимостей.

Дополнительное задание на алмазик: добавить HTTP-gateway и proto-валидацию.

*Дедлайн: 3 июня, 23:59 (сдача) / 6 июня, 23:59 (проверка)*

# Домашнее задание №3

1. Для каждого сервиса(где необходимо что-то сохранять/брать) поднять отдельную БД в __docker-compose__.
2. Сделать миграции в каждом сервисе (достаточно папки миграций и скрипта).
3. Создать необходимые таблицы.
4. Реализовать логику репозитория в каждом сервисе.
5. В качестве query builder-а можно использовать любую библиотеку (согласовать индивидуально с тьютором). Рекомендуется https://github.com/Masterminds/squirrel.
6. Драйвер для работы с postgresql: только __pgx__ (pool).
7. В одном из сервисов сделать транзакционность запросов (как на воркшопе).

Задание на алмазик:
1. Для каждой БД полнять свой балансировщик (pgbouncer или odyssey, можно и то и то). Сервисы ходят не на прямую в БД, а через балансировщик

*Дедлайн: 10 июня, 23:59 (сдача) / 13 июня, 23:59 (проверка)*

# Домашнее задание №4

1. Уменьшить время ответа Checkout.listCart при помощи worker pool. Запрашивать не более 5 SKU одновременно.

Worker pool нужно написать самостоятельно. Обязательное требование - читаемость кода и покрытие комментариями.

2. При общении с Product Service необходимо использовать лимит 10 RPS на клиентской стороне.

Допускается использование библиотечных рейт-лимитеров. В случае собственного читаемый код и комментарии обязательны.

3. Во всех слоях сервиса необходимо использовать контекст для возможности отмены вызова.

Задания на алмазик:

1. Синхронизировать рейт-лимитер при помощи БД.
2. Аннулировать заказы старше 10 минут в фоне. Позаботиться о том, чтобы реплики сервиса не штурмовали БД все вместе.

# Домашнее задание №5

Необходимо обеспечить полное покрытие бизнес-логики ручек ListCart или Purchase модульными тестами (go test -coverprofile).<br/>
Если вдруг ваши слои до сих пор не изолированны друг от друга через интерфейсы, необходимо это сделать.<br/>
В качестве генератора моков можете использовать, что душе угодно: mockery, minimoc, gomock, ... <br/>

Задание на алмазик: добавить интеграционные тесты для проверки слоя взаимодействия с базой данных.

*Дедлайн: 24 июня 23:59 (сдача) / 27 июня, 23:59 (проверка)*
